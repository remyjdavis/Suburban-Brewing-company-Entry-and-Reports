<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>New Invoice | Suburban Brewing Company</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <!-- Include JsBarcode -->
  <script src="https://cdn.jsdelivr.net/npm/jsbarcode@3.11.0/dist/JsBarcode.all.min.js"></script>

  <style>
    /* General Styles */
    body {
      font-family: Arial, sans-serif;
    }

    .topbar {
      background: #ffffff;
      border-bottom: 1px solid #e5e7eb;
      padding: 8px 24px;
      display: flex;
      align-items: center;
      justify-content: flex-start;
      font-size: 12px;
    }

    .brand-container {
      display: flex;
      align-items: center;
      font-size: 12px;
    }

    .logo {
      height: 40px;
      width: auto;
      margin-right: 10px;
    }

    .company-details {
      color: #6b7280;
      margin-left: 5px;
    }

    .company-details p {
      margin: 0;
      line-height: 1.2;
    }

    .topbar h2 {
      font-size: 20px;
      font-weight: 500;
      color: #6b7280;
      margin-left: auto;
    }

    .section h2 {
      font-size: 18px;
      margin-top: 0;
      font-weight: 600;
    }

    .invoice-details {
      display: flex;
      flex-direction: column;
      align-items: flex-end;
      margin-bottom: 20px;
    }

    /* Modal Styles */
    .modal {
      display: none;
      position: fixed;
      z-index: 1;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.4);
      padding-top: 60px;
    }

    .modal-content {
      background-color: #ffffff;
      margin: 5% auto;
      padding: 20px;
      border-radius: 10px;
      width: 40%;
      text-align: center;
    }

    .modal-content label {
      font-weight: bold;
      margin-bottom: 10px;
      display: block;
    }

    .modal-content input {
      margin: 10px;
      padding: 10px;
      width: 100%;
      border: 1px solid #ccc;
      border-radius: 6px;
    }

    .modal-content button {
      background-color: #4CAF50;
      color: white;
      padding: 10px 20px;
      border: none;
      cursor: pointer;
      border-radius: 6px;
    }

    .modal-content button:hover {
      background-color: #45a049;
    }

    /* Close Button */
    .close {
      color: #aaa;
      font-size: 28px;
      font-weight: bold;
      position: absolute;
      top: 10px;
      right: 25px;
    }

    .close:hover,
    .close:focus {
      color: black;
      text-decoration: none;
      cursor: pointer;
    }
  </style>
</head>

<body>
  <!-- Header with Company Branding -->
  <header class="topbar">
    <div class="brand-container">
      <img src="../sales/background.jpg" alt="Company Logo" class="logo">
      <div class="company-details">
        <p>Suburban Brewing Company</p>
        <p>3041 Horseshoe Pike Suite 120 & 130</p>
        <p>Honey Brook, PA 19344</p>
        <p>Sales Rep: Remy Davis | Phone: 9086421019</p>
        <p>Email: Remyjdavis90@gmail.com</p>
      </div>
    </div>
    <h2>New Invoice</h2>
  </header>

  <!-- Content Section -->
  <section class="content">
    <div class="section">
      <h2>Invoice Details</h2>
      
      <!-- Customer Search and Add New -->
      <div class="invoice-details">
        <label>Search for Customer</label>
        <input type="text" id="customerSearch" placeholder="Enter customer name or email" />
        <button id="searchButton">Search</button>
        <button id="addNewCustomer" style="display:none;">Add New Customer</button>
      </div>

      <div id="customerDetails" style="display:none;">
        <h3>Customer Info:</h3>
        <p id="customerInfo"></p>
      </div>

      <div id="customerModal" class="modal">
        <div class="modal-content">
          <span class="close" id="closeCustomerModal">&times;</span>
          <h2>Customer Information</h2>
          <label>1. Is the customer a Check Customer or Fintech Customer?</label>
          <div>
            <input type="radio" id="checkCustomer" name="customerType" value="Check Customer" checked>
            <label for="checkCustomer">Check Customer</label><br>
            <input type="radio" id="fintechCustomer" name="customerType" value="Fintech Customer">
            <label for="fintechCustomer">Fintech Customer</label><br>
          </div>

          <label>2. What is the business type?</label>
          <div>
            <input type="radio" id="retail" name="businessType" value="Retail" checked>
            <label for="retail">Retail</label><br>
            <input type="radio" id="restaurant" name="businessType" value="Restaurant">
            <label for="restaurant">Restaurant</label><br>
          </div>
          <button id="submitCustomerInfo">Submit</button>
        </div>
      </div>

      <!-- Invoice Number, Barcode, and Date -->
      <label>Invoice #</label>
      <input type="text" id="invoiceNumber" value="" readonly />
      <div id="barcode"></div>
      <div class="invoice-date" id="invoiceDate"></div>
    </div>

    <div class="section">
      <h2>Invoice Items</h2>
      <!-- Add Invoice Items Table -->
    </div>
  </section>

  <script>
    // Simulated customer database
    const customerDatabase = [
      { name: "John Doe", email: "johndoe@example.com", customerType: "Check Customer", businessType: "Retail" },
      { name: "Jane Smith", email: "janesmith@example.com", customerType: "Fintech Customer", businessType: "Restaurant" }
    ];

    // Function to search for customer
    document.getElementById("searchButton").addEventListener("click", function() {
      const searchTerm = document.getElementById("customerSearch").value.toLowerCase();
      const customer = customerDatabase.find(cust => 
        cust.name.toLowerCase().includes(searchTerm) || cust.email.toLowerCase().includes(searchTerm));

      if (customer) {
        document.getElementById("customerDetails").style.display = "block";
        document.getElementById("customerInfo").innerText = `Name: ${customer.name}, Type: ${customer.customerType}, Business: ${customer.businessType}`;
        document.getElementById("addNewCustomer").style.display = "none";
      } else {
        document.getElementById("customerDetails").style.display = "none";
        document.getElementById("addNewCustomer").style.display = "inline-block";
      }
    });

    // Open the modal when "Add New Customer" is clicked
    document.getElementById("addNewCustomer").addEventListener("click", function() {
      openCustomerModal();
    });

    // Open the customer modal
    function openCustomerModal() {
      document.getElementById("customerModal").style.display = "block";
    }

    // Close the customer modal
    document.getElementById("closeCustomerModal").onclick = function() {
      document.getElementById("customerModal").style.display = "none";
    }

    // Submit the customer info
    document.getElementById("submitCustomerInfo").onclick = function() {
      const customerType = document.querySelector('input[name="customerType"]:checked').value;
      const businessType = document.querySelector('input[name="businessType"]:checked').value;
      console.log("Customer Type:", customerType); // Handle customer type
      console.log("Business Type:", businessType); // Handle business type
      document.getElementById("customerModal").style.display = "none"; // Close modal
    };

    // Function to generate a unique invoice number
    function generateInvoiceNumber() {
      const invoiceNumber = 'INV-' + Math.floor(Math.random() * 1000000);
      document.getElementById('invoiceNumber').value = invoiceNumber;
      generateBarcode(invoiceNumber); // Generate barcode after setting the invoice number
    }

    // Function to generate the barcode based on the invoice number
    function generateBarcode(invoiceNumber) {
      JsBarcode("#barcode", invoiceNumber, {
        format: "CODE128",
        displayValue: true,
        fontSize: 20
      });
    }

    // Initialize the page by generating the invoice number and barcode
    window.onload = function() {
      generateInvoiceNumber();  // Generate on page load
      document.getElementById('invoiceDate').textContent = new Date().toLocaleDateString();  // Set current date
    };

    // Update barcode when the invoice number is changed manually
    document.getElementById('invoiceNumber').addEventListener('input', function() {
      generateBarcode(this.value);  // Update the barcode
    });
  </script>
</body>
</html>
